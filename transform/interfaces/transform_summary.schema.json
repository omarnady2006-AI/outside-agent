{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "$id": "transform_summary.schema.json",
  "title": "Transform Summary",
  "description": "Schema for the transform_summary output object from the data transformation pipeline",
  "type": "object",
  "required": [
    "copy_id",
    "forbidden_found",
    "forbidden_hits",
    "canonical_mapping_count",
    "tokenized_fields_count",
    "dropped_columns",
    "derived_fields_created",
    "normalization_changes_count",
    "duplicates_removed",
    "missing_label_count",
    "rows_dropped_missing",
    "rows_dropped_invalid"
  ],
  "properties": {
    "copy_id": {
      "type": "string",
      "description": "Unique identifier for the dataset copy being transformed"
    },
    "forbidden_found": {
      "type": "boolean",
      "description": "Whether any forbidden values were detected during transformation"
    },
    "forbidden_hits": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "List of field names where forbidden values were found (no raw values)"
    },
    "canonical_mapping_count": {
      "type": "integer",
      "minimum": 0,
      "description": "Count of distinct canonicalization mappings applied"
    },
    "tokenized_fields_count": {
      "type": "object",
      "additionalProperties": {
        "type": "integer",
        "minimum": 0
      },
      "description": "Map of field names to their tokenized value counts"
    },
    "dropped_columns": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Names of columns removed during cleaning"
    },
    "derived_fields_created": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Names of new fields generated during transformation"
    },
    "normalization_changes_count": {
      "type": "integer",
      "minimum": 0,
      "description": "Total number of normalization modifications applied"
    },
    "duplicates_removed": {
      "type": "integer",
      "minimum": 0,
      "description": "Count of duplicate rows removed"
    },
    "missing_label_count": {
      "type": "integer",
      "minimum": 0,
      "description": "Count of rows with missing target labels"
    },
    "rows_dropped_missing": {
      "type": "integer",
      "minimum": 0,
      "description": "Count of rows dropped due to missing required values"
    },
    "rows_dropped_invalid": {
      "type": "integer",
      "minimum": 0,
      "description": "Count of rows dropped due to invalid data"
    }
  }
}
